syntax = "proto3";

// Generic coordinate structure
message SharedLonLat {
    float lon = 1;
    float lat = 2;
}

// Generic bounding box structure
message SharedBounds {
    float min_lon = 1;
    float min_lat = 2;
    float max_lon = 3;
    float max_lat = 4;
}

// Node rendering structure
message RenderNode {
    uint64 id = 1;
    SharedLonLat point = 2;
}

// Way rendering structure
message RenderWay {
    uint64 id = 1;
    string line = 2;
    bool area = 3;
}

// Elements rendering structure
message RenderElementsData {
    repeated RenderNode nodes = 1;
    repeated RenderWay ways = 2;
}

// Changeset rendering structure
message RenderChangesetData {
    uint64 id = 1;
    repeated SharedBounds bounds = 2;
    optional string user_name = 3;
    optional string user_avatar = 4;
    bool closed = 5;
    string timeago = 6;
    optional string comment = 7;
    uint64 num_comments = 8;
}

// Changesets rendering structure
message RenderChangesetsData {
    repeated RenderChangesetData changesets = 1;
}

// Note rendering structure
message RenderNote {
    uint64 id = 1;
    SharedLonLat point = 2;
    string text = 3;
    bool open = 4;
}

// Notes rendering structure
message RenderNotesData {
    repeated RenderNote notes = 1;
}

// Shared user configuration
message WebUserConfig {
    bool activity_tracking = 1;
    bool crash_reporting = 2;
    optional SharedLonLat home_point = 3;
}

// Shared website configuration
message WebConfig {
    string api_url = 1;
    float map_query_area_max_size = 2;
    float note_query_area_max_size = 3;
    optional WebUserConfig user_config = 4;
}

// Generic icon structure
message ElementIcon {
    string icon = 1;
    string title = 2;
}

// Changeset elements list entry
message ChangesetElement {
    uint64 id = 1;
    uint64 version = 2;
    bool visible = 3;
    optional string name = 4;
    optional ElementIcon icon = 5;
}

// Partial changeset response params
message PartialChangesetParams {
    uint64 id = 1;
    repeated SharedBounds bounds = 2;
    repeated ChangesetElement nodes = 3;
    repeated ChangesetElement ways = 4;
    repeated ChangesetElement relations = 5;
}

// Element member list entry
message ElementMemberListEntry {
    string type = 1;
    uint64 id = 2;
    optional string role = 3;
    optional string name = 4;
    optional ElementIcon icon = 5;
}

// Partial element response params
message PartialElementParams {
    string type = 1;
    repeated ElementMemberListEntry members = 2;
    repeated ElementMemberListEntry parents = 3;
    RenderElementsData render = 4;
}

// Partial note response params
message PartialNoteParams {
    uint64 id = 1;
    SharedLonLat point = 2;
    bool open = 3;
}

// Partial query features response params
message PartialQueryFeaturesParams {
    repeated RenderElementsData renders = 1;
}

// Partial search response params
message PartialSearchParams {
    optional string bounds_str = 1;
    repeated RenderElementsData renders = 2;
    bool where_is_this = 3;
}
